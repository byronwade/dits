@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light mode - Clean with olive green primary */
    --background: 60 9% 98%;
    --foreground: 30 10% 12%;
    --card: 60 6% 97%;
    --card-foreground: 30 10% 12%;
    --card-border: 45 8% 88%;
    --popover: 60 6% 97%;
    --popover-foreground: 30 10% 12%;
    --primary: 90 35% 35%;
    --primary-foreground: 60 10% 95%;
    --secondary: 45 10% 92%;
    --secondary-foreground: 30 10% 20%;
    --muted: 45 8% 93%;
    --muted-foreground: 30 6% 45%;
    --accent: 90 25% 90%;
    --accent-foreground: 90 40% 25%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --border: 45 8% 88%;
    --input: 45 8% 88%;
    --ring: 90 35% 35%;
    --chart-1: 90 35% 35%;
    --chart-2: 45 75% 55%;
    --chart-3: 30 65% 50%;
    --chart-4: 120 40% 45%;
    --chart-5: 15 80% 55%;
    --radius: 0.5rem;
    --glow-color: 90 35% 35%;
    /* Semantic colors */
    --success: 120 60% 40%;
    --success-foreground: 0 0% 98%;
    --warning: 45 90% 45%;
    --warning-foreground: 30 10% 10%;
    --info: 200 80% 50%;
    --info-foreground: 0 0% 98%;
    /* Code block colors */
    --code-background: 30 7% 12%;
    --code-foreground: 45 10% 90%;
    --code-border: 30 6% 20%;
    /* Sidebar */
    --sidebar-background: 60 6% 97%;
    --sidebar-foreground: 30 8% 30%;
    --sidebar-primary: 90 35% 35%;
    --sidebar-primary-foreground: 60 10% 95%;
    --sidebar-accent: 90 20% 92%;
    --sidebar-accent-foreground: 30 10% 15%;
    --sidebar-border: 45 8% 88%;
    --sidebar-ring: 90 35% 35%;
  }

  .dark {
    /* Dark mode - Warm brown/olive tones */
    --background: 30 8% 7%;
    --foreground: 45 10% 93%;
    --card: 30 7% 10%;
    --card-foreground: 45 10% 93%;
    --card-border: 30 6% 18%;
    --popover: 30 7% 10%;
    --popover-foreground: 45 10% 93%;
    --primary: 90 40% 45%;
    --primary-foreground: 30 10% 8%;
    --secondary: 30 6% 15%;
    --secondary-foreground: 45 10% 90%;
    --muted: 30 6% 15%;
    --muted-foreground: 45 6% 55%;
    --accent: 90 30% 15%;
    --accent-foreground: 90 50% 65%;
    --destructive: 0 62% 30%;
    --destructive-foreground: 0 0% 98%;
    --border: 30 6% 18%;
    --input: 30 6% 18%;
    --ring: 90 40% 45%;
    --chart-1: 90 40% 45%;
    --chart-2: 45 65% 50%;
    --chart-3: 30 55% 45%;
    --chart-4: 120 45% 40%;
    --chart-5: 15 70% 50%;
    --glow-color: 84 81% 44%;
    /* Semantic colors */
    --success: 120 55% 35%;
    --success-foreground: 0 0% 98%;
    --warning: 45 85% 40%;
    --warning-foreground: 30 10% 10%;
    --info: 200 70% 45%;
    --info-foreground: 0 0% 98%;
    /* Code block colors */
    --code-background: 30 8% 6%;
    --code-foreground: 45 10% 90%;
    --code-border: 30 6% 14%;
    /* Sidebar */
    --sidebar-background: 30 8% 8%;
    --sidebar-foreground: 45 8% 90%;
    --sidebar-primary: 84 81% 44%;
    --sidebar-primary-foreground: 30 10% 8%;
    --sidebar-accent: 84 25% 15%;
    --sidebar-accent-foreground: 45 8% 90%;
    --sidebar-border: 30 6% 18%;
    --sidebar-ring: 84 81% 44%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family: var(--font-geist-sans), system-ui, sans-serif;
    /* AGENTS.md: Prevent double-tap zoom on mobile */
    -webkit-tap-highlight-color: hsl(var(--primary) / 0.1);
  }

  /* AGENTS.md: Respect safe areas for notched devices */
  html {
    --header-height: 64px;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
}

/* Hide scrollbar but keep functionality */
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
}

/* Container */
.container {
  @apply mx-auto px-4 md:px-6 max-w-7xl;
}

/* Code styling */
code {
  font-family: var(--font-geist-mono), monospace;
}

/* Inline code only */
:not(pre)>code {
  @apply bg-muted px-1.5 py-0.5 rounded text-sm font-mono;
}

/* Highlight.js syntax highlighting */
.hljs {
  background: transparent !important;
  padding: 0;
  margin: 0;
}

/* Ensure code blocks have no margin */
.not-prose pre {
  margin: 0 !important;
}

.not-prose>div[style*="code-background"] {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}

/* Light mode: use github theme (default) */
:not(.dark) pre code.hljs {
  /* GitHub light theme colors are applied */
}

/* Dark mode: override with github-dark theme colors */
.dark pre code.hljs {
  /* GitHub dark theme will override light theme */
  color: #c9d1d9;
}

.dark pre code.hljs .hljs-keyword,
.dark pre code.hljs .hljs-selector-tag,
.dark pre code.hljs .hljs-literal,
.dark pre code.hljs .hljs-title {
  color: #ff7b72;
}

.dark pre code.hljs .hljs-string,
.dark pre code.hljs .hljs-attr {
  color: #a5d6ff;
}

.dark pre code.hljs .hljs-comment,
.dark pre code.hljs .hljs-quote {
  color: #8b949e;
}

.dark pre code.hljs .hljs-number,
.dark pre code.hljs .hljs-literal {
  color: #79c0ff;
}

.dark pre code.hljs .hljs-type,
.dark pre code.hljs .hljs-class {
  color: #ffa657;
}


/* Custom scrollbar for code blocks */
pre::-webkit-scrollbar,
.overflow-x-auto::-webkit-scrollbar {
  height: 8px;
}

pre::-webkit-scrollbar-track,
.overflow-x-auto::-webkit-scrollbar-track {
  background: hsl(var(--code-background));
  border-radius: 4px;
}

pre::-webkit-scrollbar-thumb,
.overflow-x-auto::-webkit-scrollbar-thumb {
  background: hsl(var(--code-border));
  border-radius: 4px;
}

pre::-webkit-scrollbar-thumb:hover,
.overflow-x-auto::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground) / 0.3);
}

/* AGENTS.md: Smooth scrolling with reduced motion support */
html {
  scroll-behavior: smooth;
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Selection */
::selection {
  @apply bg-primary/20;
}

/* AGENTS.md: Skip to content link for keyboard navigation */
.skip-link {
  @apply absolute -top-10 left-4 z-[100] bg-primary text-primary-foreground px-4 py-2 rounded-md font-medium;
  @apply focus:top-4 transition-[top];
}

/* AGENTS.md: Visible focus rings using :focus-visible */
:focus-visible {
  @apply outline-2 outline-offset-2 outline-ring;
}

/* AGENTS.md: Group focus state with :focus-within */
.focus-group:focus-within {
  @apply ring-2 ring-ring ring-offset-2 ring-offset-background;
}

/* AGENTS.md: scroll-margin-top on headings for anchored links */
h1,
h2,
h3,
h4,
h5,
h6 {
  scroll-margin-top: 5rem;
}

/* AGENTS.md: Tabular numbers for data/comparisons */
.tabular-nums {
  font-variant-numeric: tabular-nums;
}

/* AGENTS.md: Prevent text selection during drag */
.dragging {
  user-select: none;
  -webkit-user-select: none;
}

/* AGENTS.md: Prevent overscroll in modals/drawers */
.overscroll-contain {
  overscroll-behavior: contain;
}

/* AGENTS.md: Prevent double-tap zoom on interactive elements */
button,
a,
[role="button"],
input,
select,
textarea {
  touch-action: manipulation;
}

/* AGENTS.md: Minimum hit target size for interactive elements */
.min-touch-target {
  min-height: 24px;
  min-width: 24px;
}

@media (pointer: coarse) {
  .min-touch-target {
    min-height: 44px;
    min-width: 44px;
  }
}

/* AGENTS.md: Ellipsis character for loading states */
.loading-ellipsis::after {
  content: "...";
  animation: ellipsis 1.5s infinite;
}

@keyframes ellipsis {
  0% {
    content: ".";
  }

  33% {
    content: "..";
  }

  66% {
    content: "...";
  }
}

@media (prefers-reduced-motion: reduce) {
  .loading-ellipsis::after {
    animation: none;
    content: "...";
  }
}

/* AGENTS.md: Non-breaking spaces utility */
.nbsp {
  white-space: nowrap;
}

/* Prose styling for documentation */
.prose {
  @apply max-w-none;
}

.prose h1 {
  @apply text-3xl font-bold tracking-tight mt-8 mb-4;
}

.prose h2 {
  @apply text-2xl font-semibold tracking-tight mt-8 mb-4 border-b pb-2;
}

.prose h3 {
  @apply text-xl font-semibold tracking-tight mt-6 mb-3;
}

.prose h4 {
  @apply text-lg font-semibold mt-4 mb-2;
}

.prose p {
  @apply leading-7 mb-4;
}

.prose ul {
  @apply list-disc pl-6 mb-4 space-y-2;
}

.prose ol {
  @apply list-decimal pl-6 mb-4 space-y-2;
}

.prose li {
  @apply leading-7;
}

.prose a:not(.not-prose a) {
  @apply text-primary underline underline-offset-4 hover:text-primary/80;
}

/* Remove underlines from links inside not-prose sections (cards, etc) */
.not-prose a {
  @apply no-underline;
}

/* Inline code in not-prose sections */
.not-prose code:not(pre code) {
  @apply bg-muted px-1.5 py-0.5 rounded text-sm font-mono;
}

/* Card description text styling */
.not-prose p {
  @apply leading-relaxed;
}

.prose blockquote {
  @apply border-l-4 border-primary pl-4 italic my-4;
}

.prose pre {
  @apply bg-zinc-900 dark:bg-zinc-950 text-zinc-100 rounded-lg p-4 overflow-x-auto my-4 text-sm leading-relaxed border border-zinc-800;
}

.prose pre code {
  @apply bg-transparent p-0 text-inherit font-mono;
}

.prose table {
  @apply w-full border-collapse my-4;
}

.prose th {
  @apply border-b font-semibold text-left p-2;
}

.prose td {
  @apply border-b p-2;
}

.prose hr {
  @apply my-8 border-border;
}

/* Particle animation for hero section */
@keyframes particle-rise {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0;
  }

  5% {
    opacity: 0.6;
  }

  95% {
    opacity: 0.6;
  }

  100% {
    transform: translateY(-100vh) translateX(30px);
    opacity: 0;
  }
}

@keyframes particle-float {

  0%,
  100% {
    transform: translate(0, 0) scale(1);
    opacity: 0.6;
  }

  25% {
    transform: translate(10px, -20px) scale(1.1);
    opacity: 0.8;
  }

  50% {
    transform: translate(-5px, -40px) scale(1);
    opacity: 0.6;
  }

  75% {
    transform: translate(15px, -20px) scale(0.9);
    opacity: 0.8;
  }
}

/* Gradient shift animation for hero text */
@keyframes gradient-shift {

  0%,
  100% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }
}

/* ============================================ */
/* Header "Chunk Flow" Design System           */
/* ============================================ */

/* Floating chunk animation for header background */
@keyframes float-chunk {

  0%,
  100% {
    transform: translateY(0) translateX(0) scale(1);
    opacity: 0.4;
  }

  25% {
    transform: translateY(-3px) translateX(2px) scale(1.05);
    opacity: 0.6;
  }

  50% {
    transform: translateY(-1px) translateX(-2px) scale(0.98);
    opacity: 0.5;
  }

  75% {
    transform: translateY(-4px) translateX(1px) scale(1.02);
    opacity: 0.55;
  }
}

/* Gradient flow animation for header bottom border */
@keyframes gradient-flow {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

/* Subtle pulse for logo hover */
@keyframes pulse-subtle {

  0%,
  100% {
    transform: scale(1);
  }

  50% {
    transform: scale(1.02);
  }
}

/* Nav link underline grow animation */
@keyframes grow-underline {
  from {
    transform: scaleX(0);
  }

  to {
    transform: scaleX(1);
  }
}

/* Header glassmorphism styling */
.header-glass {
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  background: hsl(var(--background) / 0.8);
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
}

.dark .header-glass {
  background: hsl(var(--background) / 0.85);
}

/* Header gradient border */
.header-gradient-border {
  /* Note: no position set here to preserve fixed/sticky from component */
}

.header-gradient-border::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg,
      hsl(var(--primary) / 0.3),
      hsl(142.1 76.2% 36.3% / 0.6),
      hsl(var(--primary) / 0.3));
  background-size: 200% 100%;
  animation: gradient-flow 4s ease infinite;
}

@media (prefers-reduced-motion: reduce) {
  .header-gradient-border::after {
    animation: none;
    background: hsl(var(--primary) / 0.4);
  }
}

/* Header chunk particles container */
.header-chunks {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
}

/* Individual floating chunk */
.header-chunk {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 2px;
  background: hsl(var(--primary) / 0.15);
  animation: float-chunk 6s ease-in-out infinite;
}

.dark .header-chunk {
  background: hsl(84 81% 44% / 0.2);
}

/* Stagger chunk animations for natural feel */
.header-chunk:nth-child(1) {
  animation-delay: 0s;
}

.header-chunk:nth-child(2) {
  animation-delay: 0.8s;
}

.header-chunk:nth-child(3) {
  animation-delay: 1.6s;
}

.header-chunk:nth-child(4) {
  animation-delay: 2.4s;
}

.header-chunk:nth-child(5) {
  animation-delay: 3.2s;
}

.header-chunk:nth-child(6) {
  animation-delay: 4s;
}

.header-chunk:nth-child(7) {
  animation-delay: 4.8s;
}

.header-chunk:nth-child(8) {
  animation-delay: 5.6s;
}

@media (prefers-reduced-motion: reduce) {
  .header-chunk {
    animation: none;
    opacity: 0.3;
  }
}

/* Logo hover effect */
.header-logo:hover .header-logo-icon {
  animation: pulse-subtle 0.6s ease-in-out;
}

@media (prefers-reduced-motion: reduce) {
  .header-logo:hover .header-logo-icon {
    animation: none;
  }
}

/* Nav link with chunk indicator */
.nav-link-chunk {
  position: relative;
}

.nav-link-chunk::after {
  content: '';
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  width: 16px;
  height: 3px;
  border-radius: 1px;
  background: linear-gradient(90deg, hsl(var(--primary)), hsl(142.1 76.2% 36.3%));
  transition: transform 0.2s ease;
}

.nav-link-chunk:hover::after,
.nav-link-chunk[aria-current="page"]::after {
  transform: translateX(-50%) scaleX(1);
}

.nav-link-chunk[aria-current="page"]::after {
  width: 24px;
}

@media (prefers-reduced-motion: reduce) {
  .nav-link-chunk::after {
    transition: none;
  }
}